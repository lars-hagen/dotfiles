#!/bin/bash

# Check if we're in the reepay-cli directory
if [[ $(pwd) == */reepay-cli ]]; then
    echo "Running code formatters..."
    poetry run black .
    poetry run ruff check --fix .
fi

git --no-pager diff --cached | sgpt --shell "
Based on the git diff provided, perform these steps:
* Create a commit message based on the staged changes
* push the changes to origin HEAD
Important:
- Analyze the file path as they might contain something useful for the commit message.
- Output each command to be executed, one per line, do not chain commands, including a comment above.
- Do not run git add, as we have already added them you focus on the git commit and push.
"